<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <nav aria-label="Back">
      <a [routerLink]="[BACK]" skipLocationChange class="govuk-back-link govuk-!-margin-bottom-5">Back</a>
    </nav>
  </div>
</div>

@if (vm$ | async; as vm) {
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds" aria-live="polite">
      <span class="govuk-caption-l">Quality Index status</span>

      @if (vm.qualityIndexThresholdAchived) {
        <h1 class="govuk-heading-l">
          You have met or exceeded the relevant quality index threshold
        </h1>
        <p class="govuk-body">
          CHP schemes (including schemes with total power capacity < 2MWe) must
          achieve the relevant quality index (QI) threshold to be considered 'Good
          Quality' CHP.
        </p>
      } @else {
        <h1 class="govuk-heading-l">
          You have not met the relevant quality index threshold
        </h1>
        <p class="govuk-body">
          All CHP schemes must achieve the relevant quality index (QI) threshold
          to be considered 'Good Quality' CHP. Normally, this threshold is based
          on annual operation, but can be based on other periods, for example on
          the Heating Season in the case of Residential Community Heating (RCH)
          Schemes.
        </p>

        <p class="govuk-body">
          As you have not met this threshold, the scheme might miss out on certain
          financial incentives that are designed to encourage energy efficiency.
        </p>
      }

      <h2 class="govuk-heading-s">
        Quality index for this scheme
        <p class="govuk-body">{{ vm.qualityIndex }}</p>
      </h2>

      <details class="govuk-details">
        <summary class="govuk-details__summary">
          <span class="govuk-details__summary-text">
            How this was calculated
          </span>
        </summary>
        <div class="govuk-details__text">
          As your scheme is in initial operation, the QI threshold for your scheme
          is 95. The formula to calculate your quality index status is:
        </div>
        <app-quality-index-status-calculations
          [formSubmission]="vm"
        ></app-quality-index-status-calculations>
      </details>
      
      <button
        class="govuk-button"
        data-module="govuk-button"
        (click)="onConfirm()"
      >
        Confirm and complete
      </button>
      
    </div>
  </div>
}